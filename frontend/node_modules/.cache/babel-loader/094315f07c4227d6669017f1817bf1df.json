{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\21650\\\\Desktop\\\\ecommerce\\\\frontend\\\\src\\\\screens\\\\OrderScreen.js\";\nimport React, { Component } from \"react\";\nimport { deliveredOrder, payOrder } from \"../actions/orderActions\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport { Col, Container, ListGroup, Row, Image, Card, Button, Alert } from \"react-bootstrap\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass OrderScreen extends Component {\n  constructor() {\n    super();\n\n    this.successPaymentHandler = (details, data) => {\n      const paymentResult = {\n        id: details.id,\n        status: details.status,\n        update_time: details.update_time,\n        email_address: details.payer.email_address\n      };\n      this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\n      setTimeout(() => {\n        window.location.reload();\n      }, 100);\n    };\n\n    this.orderDeliveredHandler = () => {\n      this.props.dispatch(deliveredOrder(this.props.match.params.id));\n      setTimeout(() => {\n        window.location.reload();\n      }, 100);\n    };\n\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\",\n      data: [],\n      sdkReady: false\n    };\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n\n    const addPaypalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get(`/api/config/paypal`);\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        this.setState({\n          sdkReady: true\n        });\n      };\n\n      document.body.appendChild(script);\n    };\n\n    const token = this.props.getLoginInfoData.userInfo.token;\n    const config = {\n      headers: {\n        // \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    };\n    axios.get(`/api/orders/${this.props.match.params.id}`, config).then(response => {\n      this.setState({\n        data: response.data\n      });\n\n      if (!response.data.isPaid) {\n        if (!window.paypal) {\n          addPaypalScript();\n        } else {\n          this.setState({\n            sdkReady: true\n          });\n        }\n      }\n    }).catch(error => {\n      console.log(error);\n    }); // order paid or not\n    // console.log(this.state.data);\n  }\n\n  render() {\n    if (!this.props.getLoginInfoData.userInfo) {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 14\n      }, this);\n    }\n\n    const order = this.state.data;\n    const user = this.props.getLoginInfoData;\n\n    if (!order.shippingAddress && !order.orderItems) {\n      return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-5\",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          ms: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Order \", order._id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Shipping:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Name: \", user.userInfo.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Email: \", user.userInfo.email]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Address: \", order.shippingAddress[0].address, \" \", order.shippingAddress[0].city, \" \", order.shippingAddress[0].postalCode, \" \", order.shippingAddress[0].country]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 17\n              }, this), order.isDelivered ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"Delivere at \", order.paidAt]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"danger\",\n                children: \"Not Delivered\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Payment:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Method: \", order.paymentMethod]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 17\n              }, this), order.isPaid ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"Paid at \", order.paidAt]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"danger\",\n                children: \"Not Paid\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Order Items:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 17\n              }, this), order.orderItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Cart is empty\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(ListGroup, {\n                variant: \"flush\",\n                children: order.orderItems.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                    children: /*#__PURE__*/_jsxDEV(Row, {\n                      children: [/*#__PURE__*/_jsxDEV(Col, {\n                        md: 1,\n                        children: /*#__PURE__*/_jsxDEV(Image, {\n                          src: item.image,\n                          alt: item.name,\n                          fluid: true,\n                          rounded: true\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 163,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 162,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        children: /*#__PURE__*/_jsxDEV(Link, {\n                          to: `/product/${item.product}`,\n                          children: item.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 171,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 170,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        md: 4,\n                        children: [item.qty, \" x $\", item.price, \" = $\", item.qty * item.price]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 176,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 161,\n                      columnNumber: 27\n                    }, this)\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Order Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                variant: \"flush\",\n                children: [/*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Items\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 199,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.itemsPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 200,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 198,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Shipping\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.shippingPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 205,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 203,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Tax\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 209,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.taxPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 210,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 213,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", order.totalPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 214,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 17\n              }, this), !order.isPaid && !user.userInfo.isAdmin && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: !this.state.sdkReady ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n                  amount: order.totalPrice,\n                  onSuccess: (details, data) => this.successPaymentHandler(details, data)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 19\n              }, this), user.userInfo.isAdmin && order.isPaid && !order.isDelivered && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"btn btn-block\",\n                  type: \"button\",\n                  onClick: this.orderDeliveredHandler,\n                  children: \"Mark As Delivered\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderDetailsData: state.orderDetails,\n    getOrderPaymentData: state.orderPay\n  };\n};\n\nexport default connect(mapStateToProps)(OrderScreen);","map":{"version":3,"sources":["C:/Users/21650/Desktop/ecommerce/frontend/src/screens/OrderScreen.js"],"names":["React","Component","deliveredOrder","payOrder","PayPalButton","connect","CheckoutSteps","axios","Loader","Col","Container","ListGroup","Row","Image","Card","Button","Alert","Link","Redirect","OrderScreen","constructor","successPaymentHandler","details","data","paymentResult","id","status","update_time","email_address","payer","props","dispatch","match","params","setTimeout","window","location","reload","orderDeliveredHandler","state","taxPrice","shippingPrice","totalPrice","itemsPrice","sdkReady","componentDidMount","scrollTo","addPaypalScript","clientId","get","script","document","createElement","type","src","async","onload","setState","body","appendChild","token","getLoginInfoData","userInfo","config","headers","Authorization","then","response","isPaid","paypal","catch","error","console","log","render","order","user","shippingAddress","orderItems","_id","name","email","address","city","postalCode","country","isDelivered","paidAt","paymentMethod","length","map","item","index","image","product","qty","price","isAdmin","mapStateToProps","userLogin","getCartData","cart","getOrderDetailsData","orderDetails","getOrderPaymentData","orderPay"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { deliveredOrder, payOrder } from \"../actions/orderActions\";\r\nimport { PayPalButton } from \"react-paypal-button-v2\";\r\nimport { connect } from \"react-redux\";\r\nimport CheckoutSteps from \"../component/CheckoutSteps\";\r\nimport axios from \"axios\";\r\nimport Loader from \"../component/Loader\";\r\nimport {\r\n  Col,\r\n  Container,\r\n  ListGroup,\r\n  Row,\r\n  Image,\r\n  Card,\r\n  Button,\r\n  Alert,\r\n} from \"react-bootstrap\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\n\r\nclass OrderScreen extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      taxPrice: \"\",\r\n      shippingPrice: \"\",\r\n      totalPrice: \"\",\r\n      itemsPrice: \"\",\r\n      data: [],\r\n      sdkReady: false,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.scrollTo(0, 0);\r\n\r\n    const addPaypalScript = async () => {\r\n      const { data: clientId } = await axios.get(`/api/config/paypal`);\r\n\r\n      const script = document.createElement(\"script\");\r\n      script.type = \"text/javascript\";\r\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\r\n      script.async = true;\r\n\r\n      script.onload = () => {\r\n        this.setState({\r\n          sdkReady: true,\r\n        });\r\n      };\r\n      document.body.appendChild(script);\r\n    };\r\n\r\n    const token = this.props.getLoginInfoData.userInfo.token;\r\n    const config = {\r\n      headers: {\r\n        // \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    };\r\n    axios\r\n      .get(`/api/orders/${this.props.match.params.id}`, config)\r\n      .then((response) => {\r\n        this.setState({\r\n          data: response.data,\r\n        });\r\n\r\n        if (!response.data.isPaid) {\r\n          if (!window.paypal) {\r\n            addPaypalScript();\r\n          } else {\r\n            this.setState({\r\n              sdkReady: true,\r\n            });\r\n          }\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n\r\n    // order paid or not\r\n    // console.log(this.state.data);\r\n  }\r\n\r\n  successPaymentHandler = (details, data) => {\r\n    const paymentResult = {\r\n      id: details.id,\r\n      status: details.status,\r\n      update_time: details.update_time,\r\n      email_address: details.payer.email_address,\r\n    };\r\n    this.props.dispatch(payOrder(this.props.match.params.id, paymentResult));\r\n\r\n    setTimeout(() => {\r\n      window.location.reload();\r\n    }, 100);\r\n  };\r\n\r\n  orderDeliveredHandler = () => {\r\n    this.props.dispatch(deliveredOrder(this.props.match.params.id));\r\n    setTimeout(() => {\r\n      window.location.reload();\r\n    }, 100);\r\n  };\r\n\r\n  render() {\r\n    if (!this.props.getLoginInfoData.userInfo) {\r\n      return <Redirect to='/login' />;\r\n    }\r\n\r\n    const order = this.state.data;\r\n\r\n    const user = this.props.getLoginInfoData;\r\n    if (!order.shippingAddress && !order.orderItems) {\r\n      return <Loader />;\r\n    }\r\n\r\n    return (\r\n      <Container className='py-5'>\r\n        <Row>\r\n          <Col ms={8}>\r\n            <h4>Order {order._id}</h4>\r\n\r\n            <ListGroup variant='flush'>\r\n              <ListGroup.Item>\r\n                <h4>Shipping:</h4>\r\n                <p>Name: {user.userInfo.name}</p>\r\n                <p>Email: {user.userInfo.email}</p>\r\n                <p>\r\n                  Address: {order.shippingAddress[0].address}{\" \"}\r\n                  {order.shippingAddress[0].city}{\" \"}\r\n                  {order.shippingAddress[0].postalCode}{\" \"}\r\n                  {order.shippingAddress[0].country}\r\n                </p>\r\n\r\n                {order.isDelivered ? (\r\n                  <Alert variant='success'>Delivere at {order.paidAt}</Alert>\r\n                ) : (\r\n                  <Alert variant='danger'>Not Delivered</Alert>\r\n                )}\r\n              </ListGroup.Item>\r\n\r\n              <ListGroup.Item>\r\n                <h4>Payment:</h4>\r\n                <p>Method: {order.paymentMethod}</p>\r\n                {order.isPaid ? (\r\n                  <Alert variant='success'>Paid at {order.paidAt}</Alert>\r\n                ) : (\r\n                  <Alert variant='danger'>Not Paid</Alert>\r\n                )}\r\n              </ListGroup.Item>\r\n\r\n              <ListGroup.Item>\r\n                <h4>Order Items:</h4>\r\n                {order.orderItems.length === 0 ? (\r\n                  <p>Cart is empty</p>\r\n                ) : (\r\n                  <ListGroup variant='flush'>\r\n                    {order.orderItems.map((item, index) => {\r\n                      return (\r\n                        <ListGroup.Item key={index}>\r\n                          <Row>\r\n                            <Col md={1}>\r\n                              <Image\r\n                                src={item.image}\r\n                                alt={item.name}\r\n                                fluid\r\n                                rounded\r\n                              />\r\n                            </Col>\r\n                            <Col>\r\n                              <Link to={`/product/${item.product}`}>\r\n                                {item.name}\r\n                              </Link>\r\n                            </Col>\r\n\r\n                            <Col md={4}>\r\n                              {item.qty} x ${item.price} = $\r\n                              {item.qty * item.price}\r\n                            </Col>\r\n                          </Row>\r\n                        </ListGroup.Item>\r\n                      );\r\n                    })}\r\n                  </ListGroup>\r\n                )}\r\n              </ListGroup.Item>\r\n            </ListGroup>\r\n          </Col>\r\n\r\n          <Col md={4}>\r\n            <Card>\r\n              <ListGroup variant='flush'>\r\n                <ListGroup.Item>\r\n                  <h4>Order Summary</h4>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item variant='flush'>\r\n                  <Row>\r\n                    <Col>Items</Col>\r\n                    <Col>${order.itemsPrice}</Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col>Shipping</Col>\r\n                    <Col>${order.shippingPrice}</Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col>Tax</Col>\r\n                    <Col>${order.taxPrice}</Col>\r\n                  </Row>\r\n                  <Row>\r\n                    <Col>Total</Col>\r\n                    <Col>${order.totalPrice}</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                {!order.isPaid && !user.userInfo.isAdmin && (\r\n                  <ListGroup.Item>\r\n                    {!this.state.sdkReady ? (\r\n                      <Loader />\r\n                    ) : (\r\n                      <PayPalButton\r\n                        amount={order.totalPrice}\r\n                        onSuccess={(details, data) =>\r\n                          this.successPaymentHandler(details, data)\r\n                        }\r\n                      />\r\n                    )}\r\n                  </ListGroup.Item>\r\n                )}\r\n\r\n                {user.userInfo.isAdmin && order.isPaid && !order.isDelivered && (\r\n                  <ListGroup.Item>\r\n                    <Button\r\n                      className='btn btn-block'\r\n                      type='button'\r\n                      onClick={this.orderDeliveredHandler}>\r\n                      Mark As Delivered\r\n                    </Button>\r\n                  </ListGroup.Item>\r\n                )}\r\n              </ListGroup>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    getLoginInfoData: state.userLogin,\r\n    getCartData: state.cart,\r\n    getOrderDetailsData: state.orderDetails,\r\n    getOrderPaymentData: state.orderPay,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(OrderScreen);\r\n"]},"metadata":{},"sourceType":"module"}