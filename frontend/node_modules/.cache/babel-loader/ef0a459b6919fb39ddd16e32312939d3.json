{"ast":null,"code":"var _jsxFileName = \"D:\\\\ecommerce\\\\frontend\\\\src\\\\screens\\\\PlaceOrder.js\";\nimport React, { Component } from \"react\";\nimport { createOrder } from \"../actions/orderActions\";\nimport { connect } from \"react-redux\";\nimport CheckoutSteps from \"../component/CheckoutSteps\";\nimport { Col, Container, ListGroup, Row, Image, Card, Button } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport Loader from \"../component/Loader\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass PlaceOrder extends Component {\n  constructor() {\n    super();\n\n    this.placeOrderHandler = () => {\n      const cart = this.props.getCartData;\n      const {\n        taxPrice,\n        shippingPrice,\n        totalPrice,\n        itemsPrice\n      } = this.state;\n      const token = this.props.getLoginInfoData.userInfo.token;\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      };\n      axios.post(`/api/orders`, {\n        orderItems: cart.cartItems,\n        shippingAddress: cart.shippingAddress,\n        paymentMethod: cart.paymentAddress.paymentMethod,\n        taxPrice,\n        shippingPrice,\n        totalPrice,\n        itemsPrice\n      }, config).then(response => {\n        localStorage.removeItem(\"cartItems\", []);\n        this.props.history.push(`/order/${response.data._id}`);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.addDecimals = num => {\n      return (Math.round(num * 100) / 100).toFixed(2);\n    };\n\n    this.state = {\n      taxPrice: \"\",\n      shippingPrice: \"\",\n      totalPrice: \"\",\n      itemsPrice: \"\"\n    };\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  componentDidMount() {\n    const cart = this.props.getCartData;\n    const itemsPrice = cart.cartItems.reduce((acc, item) => acc + item.qty * item.price, 0).toFixed(2);\n    const shippingPrice = itemsPrice > 100 ? 0 : 100;\n    const taxPrice = this.addDecimals(Number((0.05 * itemsPrice).toFixed(2)));\n    const totalPrice = (Number(itemsPrice) + Number(shippingPrice) + Number(taxPrice)).toFixed(2);\n    this.setState({\n      taxPrice,\n      shippingPrice,\n      totalPrice,\n      itemsPrice\n    });\n  }\n\n  render() {\n    const cart = this.props.getCartData;\n    const {\n      itemsPrice,\n      shippingPrice,\n      taxPrice,\n      totalPrice\n    } = this.state;\n\n    if (!cart.cartItems) {\n      return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-5\",\n      children: [/*#__PURE__*/_jsxDEV(CheckoutSteps, {\n        step1: true,\n        step2: true,\n        step3: true,\n        step4: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          ms: 8,\n          children: /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Shipping:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [cart.shippingAddress.address, \", \", cart.shippingAddress.city, \",\", \" \", cart.shippingAddress.postalCode, \",\", \" \", cart.shippingAddress.country]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Payment:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Method: \", cart.paymentAddress.paymentMethod]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Order Items:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 17\n              }, this), cart.cartItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Cart is empty\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(ListGroup, {\n                variant: \"flush\",\n                children: cart.cartItems.map((item, index) => {\n                  return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                    children: /*#__PURE__*/_jsxDEV(Row, {\n                      children: [/*#__PURE__*/_jsxDEV(Col, {\n                        md: 1,\n                        children: /*#__PURE__*/_jsxDEV(Image, {\n                          src: item.image,\n                          alt: item.name,\n                          fluid: true,\n                          rounded: true\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 132,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 131,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        children: /*#__PURE__*/_jsxDEV(Link, {\n                          to: `/product/${item.product}`,\n                          children: item.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 140,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 139,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        md: 4,\n                        children: [item.qty, \" x $\", item.price, \" = $\", item.qty * item.price]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 145,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 130,\n                      columnNumber: 27\n                    }, this)\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 129,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Order Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                variant: \"flush\",\n                children: [/*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Items\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 168,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", itemsPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 167,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Shipping\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", shippingPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 174,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Tax\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 178,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", taxPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 179,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 177,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 182,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", totalPrice]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 183,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  disabled: this.props.getLoginInfoData.userInfo.isAdmin,\n                  type: \"button\",\n                  className: \"btn-block\",\n                  disabled: cart.cartItems.length === 0,\n                  onClick: () => this.placeOrderHandler(),\n                  children: \"Place Order\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 19\n                }, this), this.props.getLoginInfoData.userInfo.isAdmin && /*#__PURE__*/_jsxDEV(\"label\", {\n                  style: {\n                    opacity: 0.8,\n                    fontSize: 12\n                  },\n                  children: \"You are not able to buy your own product\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    getLoginInfoData: state.userLogin,\n    getCartData: state.cart,\n    getOrderData: state.createOrder\n  };\n};\n\nexport default connect(mapStateToProps)(PlaceOrder);","map":{"version":3,"sources":["D:/ecommerce/frontend/src/screens/PlaceOrder.js"],"names":["React","Component","createOrder","connect","CheckoutSteps","Col","Container","ListGroup","Row","Image","Card","Button","Link","axios","Loader","PlaceOrder","constructor","placeOrderHandler","cart","props","getCartData","taxPrice","shippingPrice","totalPrice","itemsPrice","state","token","getLoginInfoData","userInfo","config","headers","Authorization","post","orderItems","cartItems","shippingAddress","paymentMethod","paymentAddress","then","response","localStorage","removeItem","history","push","data","_id","catch","error","console","log","addDecimals","num","Math","round","toFixed","componentDidMount","window","scrollTo","reduce","acc","item","qty","price","Number","setState","render","address","city","postalCode","country","length","map","index","image","name","product","isAdmin","opacity","fontSize","mapStateToProps","userLogin","getOrderData"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { createOrder } from \"../actions/orderActions\";\r\nimport { connect } from \"react-redux\";\r\nimport CheckoutSteps from \"../component/CheckoutSteps\";\r\nimport {\r\n  Col,\r\n  Container,\r\n  ListGroup,\r\n  Row,\r\n  Image,\r\n  Card,\r\n  Button,\r\n} from \"react-bootstrap\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport Loader from \"../component/Loader\";\r\n\r\nclass PlaceOrder extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      taxPrice: \"\",\r\n      shippingPrice: \"\",\r\n      totalPrice: \"\",\r\n      itemsPrice: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.scrollTo(0, 0);\r\n  }\r\n\r\n  placeOrderHandler = () => {\r\n    const cart = this.props.getCartData;\r\n    const { taxPrice, shippingPrice, totalPrice, itemsPrice } = this.state;\r\n\r\n    const token = this.props.getLoginInfoData.userInfo.token;\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    };\r\n    axios\r\n      .post(\r\n        `/api/orders`,\r\n        {\r\n          orderItems: cart.cartItems,\r\n          shippingAddress: cart.shippingAddress,\r\n          paymentMethod: cart.paymentAddress.paymentMethod,\r\n          taxPrice,\r\n          shippingPrice,\r\n          totalPrice,\r\n          itemsPrice,\r\n        },\r\n        config\r\n      )\r\n      .then((response) => {\r\n        localStorage.removeItem(\"cartItems\", []);\r\n\r\n        this.props.history.push(`/order/${response.data._id}`);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  componentDidMount() {\r\n    const cart = this.props.getCartData;\r\n    const itemsPrice = cart.cartItems\r\n      .reduce((acc, item) => acc + item.qty * item.price, 0)\r\n      .toFixed(2);\r\n\r\n    const shippingPrice = itemsPrice > 100 ? 0 : 100;\r\n    const taxPrice = this.addDecimals(Number((0.05 * itemsPrice).toFixed(2)));\r\n    const totalPrice = (\r\n      Number(itemsPrice) +\r\n      Number(shippingPrice) +\r\n      Number(taxPrice)\r\n    ).toFixed(2);\r\n\r\n    this.setState({\r\n      taxPrice,\r\n      shippingPrice,\r\n      totalPrice,\r\n      itemsPrice,\r\n    });\r\n  }\r\n\r\n  addDecimals = (num) => {\r\n    return (Math.round(num * 100) / 100).toFixed(2);\r\n  };\r\n\r\n  render() {\r\n    const cart = this.props.getCartData;\r\n    const { itemsPrice, shippingPrice, taxPrice, totalPrice } = this.state;\r\n    if (!cart.cartItems) {\r\n      return <Loader />;\r\n    }\r\n\r\n    return (\r\n      <Container className='py-5'>\r\n        <CheckoutSteps step1 step2 step3 step4 />\r\n        <Row>\r\n          <Col ms={8}>\r\n            <ListGroup variant='flush'>\r\n              <ListGroup.Item>\r\n                <h4>Shipping:</h4>\r\n                <p>\r\n                  {cart.shippingAddress.address}, {cart.shippingAddress.city},{\" \"}\r\n                  {cart.shippingAddress.postalCode},{\" \"}\r\n                  {cart.shippingAddress.country}\r\n                </p>\r\n              </ListGroup.Item>\r\n\r\n              <ListGroup.Item>\r\n                <h4>Payment:</h4>\r\n                <p>Method: {cart.paymentAddress.paymentMethod}</p>\r\n              </ListGroup.Item>\r\n\r\n              <ListGroup.Item>\r\n                <h4>Order Items:</h4>\r\n                {cart.cartItems.length === 0 ? (\r\n                  <p>Cart is empty</p>\r\n                ) : (\r\n                  <ListGroup variant='flush'>\r\n                    {cart.cartItems.map((item, index) => {\r\n                      return (\r\n                        <ListGroup.Item key={index}>\r\n                          <Row>\r\n                            <Col md={1}>\r\n                              <Image\r\n                                src={item.image}\r\n                                alt={item.name}\r\n                                fluid\r\n                                rounded\r\n                              />\r\n                            </Col>\r\n                            <Col>\r\n                              <Link to={`/product/${item.product}`}>\r\n                                {item.name}\r\n                              </Link>\r\n                            </Col>\r\n\r\n                            <Col md={4}>\r\n                              {item.qty} x ${item.price} = $\r\n                              {item.qty * item.price}\r\n                            </Col>\r\n                          </Row>\r\n                        </ListGroup.Item>\r\n                      );\r\n                    })}\r\n                  </ListGroup>\r\n                )}\r\n              </ListGroup.Item>\r\n            </ListGroup>\r\n          </Col>\r\n\r\n          <Col md={4}>\r\n            <Card>\r\n              <ListGroup variant='flush'>\r\n                <ListGroup.Item>\r\n                  <h4>Order Summary</h4>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item variant='flush'>\r\n                  <Row>\r\n                    <Col>Items</Col>\r\n                    <Col>${itemsPrice}</Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col>Shipping</Col>\r\n                    <Col>${shippingPrice}</Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col>Tax</Col>\r\n                    <Col>${taxPrice}</Col>\r\n                  </Row>\r\n                  <Row>\r\n                    <Col>Total</Col>\r\n                    <Col>${totalPrice}</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                  <Button\r\n                    disabled={this.props.getLoginInfoData.userInfo.isAdmin}\r\n                    type='button'\r\n                    className='btn-block'\r\n                    disabled={cart.cartItems.length === 0}\r\n                    onClick={() => this.placeOrderHandler()}>\r\n                    Place Order\r\n                  </Button>\r\n                  {this.props.getLoginInfoData.userInfo.isAdmin && (\r\n                    <label style={{ opacity: 0.8, fontSize: 12 }}>\r\n                      You are not able to buy your own product\r\n                    </label>\r\n                  )}\r\n                </ListGroup.Item>\r\n              </ListGroup>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    getLoginInfoData: state.userLogin,\r\n    getCartData: state.cart,\r\n    getOrderData: state.createOrder,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(PlaceOrder);\r\n"]},"metadata":{},"sourceType":"module"}